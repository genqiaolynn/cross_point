# -*- coding:utf-8 -*-
__author__ = 'lynn'
__date__ = '2021/2/19 18:09'


'''
考号的情况有点多：exam_number,exam_number_s,exam_number_w,需要分别考虑补全规则
'''

# 拿到考号区域，只需要调整考号区域


def adjust_exam_number(regions):
    exam_number_w_regions = list()
    exam_number_regions = list()
    for i in range(len(regions) - 1, -1, -1):
        region = regions[i]
        if region['class_name'] == 'exam_number_w':
            exam_number_w_regions.append(region)
        if region['class_name'] == 'exam_number':
            exam_number_regions.append(region)
            regions.pop(i)

    exam_number_region = exam_number_regions[0]
    if len(exam_number_regions) > 1:
        exam_number_regions = sorted(exam_number_regions, key=lambda x: x['bounding_box']['ymin'])
        exam_number_region = exam_number_regions[0]

    exam_number_w_index = 0
    if len(exam_number_w_regions) > 1:
        distance = [abs(int(ele['bounding_box']['ymax']) - int(exam_number_region['bounding_box']['ymin']))
                    for ele in exam_number_w_regions]
        exam_number_w_index = distance.index(min(distance))
    exam_number_w_region = exam_number_w_regions[exam_number_w_index]

    standard = exam_number_w_region['bounding_box']
    exam_number_region['bounding_box'].update({'xmin': standard['xmin'], 'xmax': standard['xmax']})
    regions.append(exam_number_region)

    return regions


if __name__ == '__main__':
    regions = [{'class_name': 'attention', 'bounding_box': {'xmin': 809, 'ymin': 372, 'xmax': 1490, 'ymax': 715}, 'score': '0.9999'}, {'class_name': 'choice', 'bounding_box': {'xmin': 128, 'ymin': 758, 'xmax': 1421, 'ymax': 1500}, 'score': '0.9549'}, {'class_name': 'choice_m', 'bounding_box': {'xmin': 546, 'ymin': 800, 'xmax': 797, 'ymax': 1008}, 'score': '1.0000'}, {'class_name': 'choice_m', 'bounding_box': {'xmin': 883, 'ymin': 795, 'xmax': 1131, 'ymax': 1003}, 'score': '1.0000'}, {'class_name': 'choice_m', 'bounding_box': {'xmin': 548, 'ymin': 1046, 'xmax': 795, 'ymax': 1254}, 'score': '1.0000'}, {'class_name': 'choice_m', 'bounding_box': {'xmin': 883, 'ymin': 1050, 'xmax': 1133, 'ymax': 1256}, 'score': '1.0000'}, {'class_name': 'choice_m', 'bounding_box': {'xmin': 1206, 'ymin': 794, 'xmax': 1458, 'ymax': 1002}, 'score': '1.0000'}, {'class_name': 'choice_m', 'bounding_box': {'xmin': 1209, 'ymin': 1038, 'xmax': 1459, 'ymax': 1246}, 'score': '1.0000'}, {'class_name': 'choice_m', 'bounding_box': {'xmin': 196, 'ymin': 804, 'xmax': 445, 'ymax': 1008}, 'score': '1.0000'}, {'class_name': 'choice_m', 'bounding_box': {'xmin': 196, 'ymin': 1047, 'xmax': 445, 'ymax': 1255}, 'score': '1.0000'}, {'class_name': 'choice_m', 'bounding_box': {'xmin': 194, 'ymin': 1300, 'xmax': 448, 'ymax': 1504}, 'score': '1.0000'}, {'class_name': 'choice_m', 'bounding_box': {'xmin': 544, 'ymin': 1298, 'xmax': 794, 'ymax': 1507}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 883, 'ymin': 1168, 'xmax': 1133, 'ymax': 1206}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 884, 'ymin': 1127, 'xmax': 1134, 'ymax': 1165}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 194, 'ymin': 920, 'xmax': 446, 'ymax': 960}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 197, 'ymin': 879, 'xmax': 446, 'ymax': 918}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 197, 'ymin': 1087, 'xmax': 448, 'ymax': 1127}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 550, 'ymin': 1128, 'xmax': 795, 'ymax': 1168}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 548, 'ymin': 1086, 'xmax': 793, 'ymax': 1126}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 196, 'ymin': 1130, 'xmax': 446, 'ymax': 1169}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 883, 'ymin': 1085, 'xmax': 1131, 'ymax': 1124}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 1206, 'ymin': 1165, 'xmax': 1458, 'ymax': 1204}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 1209, 'ymin': 1124, 'xmax': 1462, 'ymax': 1163}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 546, 'ymin': 919, 'xmax': 797, 'ymax': 958}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 197, 'ymin': 839, 'xmax': 446, 'ymax': 877}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 198, 'ymin': 1420, 'xmax': 450, 'ymax': 1461}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 546, 'ymin': 837, 'xmax': 795, 'ymax': 877}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 548, 'ymin': 1335, 'xmax': 792, 'ymax': 1375}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 1209, 'ymin': 832, 'xmax': 1459, 'ymax': 872}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 1212, 'ymin': 1082, 'xmax': 1459, 'ymax': 1121}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 547, 'ymin': 878, 'xmax': 795, 'ymax': 918}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 550, 'ymin': 1169, 'xmax': 795, 'ymax': 1210}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 546, 'ymin': 1462, 'xmax': 797, 'ymax': 1504}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 882, 'ymin': 918, 'xmax': 1133, 'ymax': 956}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 196, 'ymin': 1463, 'xmax': 452, 'ymax': 1503}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 1209, 'ymin': 958, 'xmax': 1458, 'ymax': 1000}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 884, 'ymin': 877, 'xmax': 1133, 'ymax': 916}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 883, 'ymin': 1050, 'xmax': 1131, 'ymax': 1081}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 1207, 'ymin': 874, 'xmax': 1461, 'ymax': 912}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 882, 'ymin': 959, 'xmax': 1136, 'ymax': 1001}, 'score': '1.0000'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 548, 'ymin': 961, 'xmax': 794, 'ymax': 1005}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 1209, 'ymin': 795, 'xmax': 1461, 'ymax': 829}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 884, 'ymin': 1209, 'xmax': 1127, 'ymax': 1254}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 198, 'ymin': 802, 'xmax': 446, 'ymax': 835}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 198, 'ymin': 1300, 'xmax': 443, 'ymax': 1337}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 546, 'ymin': 1377, 'xmax': 794, 'ymax': 1417}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 883, 'ymin': 795, 'xmax': 1131, 'ymax': 834}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 1210, 'ymin': 1038, 'xmax': 1463, 'ymax': 1080}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 197, 'ymin': 1380, 'xmax': 448, 'ymax': 1417}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 196, 'ymin': 1046, 'xmax': 449, 'ymax': 1085}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 197, 'ymin': 1170, 'xmax': 444, 'ymax': 1211}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 547, 'ymin': 1302, 'xmax': 793, 'ymax': 1333}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 543, 'ymin': 1420, 'xmax': 795, 'ymax': 1458}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 1205, 'ymin': 1206, 'xmax': 1449, 'ymax': 1242}, 'score': '0.9999'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 1206, 'ymin': 916, 'xmax': 1461, 'ymax': 954}, 'score': '0.9998'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 884, 'ymin': 836, 'xmax': 1130, 'ymax': 875}, 'score': '0.9998'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 196, 'ymin': 1339, 'xmax': 445, 'ymax': 1378}, 'score': '0.9998'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 543, 'ymin': 1046, 'xmax': 795, 'ymax': 1084}, 'score': '0.9998'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 198, 'ymin': 963, 'xmax': 449, 'ymax': 1005}, 'score': '0.9998'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 193, 'ymin': 1213, 'xmax': 448, 'ymax': 1249}, 'score': '0.9996'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 547, 'ymin': 805, 'xmax': 798, 'ymax': 835}, 'score': '0.9989'}, {'class_name': 'choice_s', 'bounding_box': {'xmin': 548, 'ymin': 1212, 'xmax': 801, 'ymax': 1248}, 'score': '0.9983'}, {'class_name': 'exam_number', 'bounding_box': {'xmin': 157, 'ymin': 369, 'xmax': 809, 'ymax': 716}, 'score': '1.0000'}, {'class_name': 'exam_number_s', 'bounding_box': {'xmin': 563, 'ymin': 369, 'xmax': 633, 'ymax': 715}, 'score': '1.0000'}, {'class_name': 'exam_number_s', 'bounding_box': {'xmin': 483, 'ymin': 369, 'xmax': 554, 'ymax': 714}, 'score': '1.0000'}, {'class_name': 'exam_number_s', 'bounding_box': {'xmin': 403, 'ymin': 368, 'xmax': 472, 'ymax': 716}, 'score': '1.0000'}, {'class_name': 'exam_number_s', 'bounding_box': {'xmin': 640, 'ymin': 367, 'xmax': 711, 'ymax': 716}, 'score': '1.0000'}, {'class_name': 'exam_number_s', 'bounding_box': {'xmin': 242, 'ymin': 369, 'xmax': 313, 'ymax': 716}, 'score': '1.0000'}, {'class_name': 'exam_number_s', 'bounding_box': {'xmin': 322, 'ymin': 369, 'xmax': 393, 'ymax': 717}, 'score': '1.0000'}, {'class_name': 'exam_number_s', 'bounding_box': {'xmin': 718, 'ymin': 368, 'xmax': 801, 'ymax': 715}, 'score': '0.9999'}, {'class_name': 'exam_number_s', 'bounding_box': {'xmin': 165, 'ymin': 368, 'xmax': 233, 'ymax': 718}, 'score': '0.9999'}, {'class_name': 'exam_number_w', 'bounding_box': {'xmin': 154, 'ymin': 323, 'xmax': 812, 'ymax': 381}, 'score': '0.9996'}, {'class_name': 'info_title', 'bounding_box': {'xmin': 484, 'ymin': 151, 'xmax': 1136, 'ymax': 210}, 'score': '1.0000'}, {'class_name': 'page', 'bounding_box': {'xmin': 670, 'ymin': 2208, 'xmax': 901, 'ymax': 2238}, 'score': '0.9998'}, {'class_name': 'solve', 'bounding_box': {'xmin': 156, 'ymin': 1580, 'xmax': 1492, 'ymax': 2171}, 'score': '1.0000'}, {'class_name': 'type_score', 'bounding_box': {'xmin': 185, 'ymin': 1597, 'xmax': 328, 'ymax': 1622}, 'score': '1.0000'}, {'class_name': 'type_score', 'bounding_box': {'xmin': 158, 'ymin': 761, 'xmax': 597, 'ymax': 788}, 'score': '0.9998'}, {'class_name': 'type_score', 'bounding_box': {'xmin': 156, 'ymin': 1552, 'xmax': 374, 'ymax': 1579}, 'score': '0.9997'}, {'class_name': 'type_score_n', 'bounding_box': {'xmin': 176, 'ymin': 1587, 'xmax': 229, 'ymax': 1630}, 'score': '1.0000'}, {'class_name': 'type_score_n', 'bounding_box': {'xmin': 151, 'ymin': 751, 'xmax': 205, 'ymax': 798}, 'score': '1.0000'}, {'class_name': 'choice_n', 'bounding_box': {'xmin': 1152, 'ymin': 792, 'xmax': 1204, 'ymax': 1002}, 'score': '1.0000'}, {'class_name': 'choice_n', 'bounding_box': {'xmin': 827, 'ymin': 793, 'xmax': 878, 'ymax': 1002}, 'score': '1.0000'}, {'class_name': 'choice_n', 'bounding_box': {'xmin': 827, 'ymin': 1044, 'xmax': 878, 'ymax': 1255}, 'score': '1.0000'}, {'class_name': 'choice_n', 'bounding_box': {'xmin': 141, 'ymin': 795, 'xmax': 192, 'ymax': 1009}, 'score': '1.0000'}, {'class_name': 'choice_n', 'bounding_box': {'xmin': 144, 'ymin': 1044, 'xmax': 196, 'ymax': 1256}, 'score': '1.0000'}, {'class_name': 'choice_n', 'bounding_box': {'xmin': 495, 'ymin': 1046, 'xmax': 546, 'ymax': 1254}, 'score': '1.0000'}, {'class_name': 'choice_n', 'bounding_box': {'xmin': 486, 'ymin': 802, 'xmax': 539, 'ymax': 1008}, 'score': '0.9999'}, {'class_name': 'choice_n', 'bounding_box': {'xmin': 1151, 'ymin': 1049, 'xmax': 1204, 'ymax': 1253}, 'score': '0.9999'}, {'class_name': 'choice_n', 'bounding_box': {'xmin': 487, 'ymin': 1295, 'xmax': 539, 'ymax': 1500}, 'score': '0.9999'}, {'class_name': 'choice_n', 'bounding_box': {'xmin': 147, 'ymin': 1289, 'xmax': 198, 'ymax': 1501}, 'score': '0.9999'}, {'class_name': 'student_info', 'bounding_box': {'xmin': 811, 'ymin': 304, 'xmax': 1123, 'ymax': 353}, 'score': '1.0000'}, {'class_name': 'student_info', 'bounding_box': {'xmin': 373, 'ymin': 219, 'xmax': 695, 'ymax': 274}, 'score': '0.9999'}, {'class_name': 'student_info', 'bounding_box': {'xmin': 931, 'ymin': 207, 'xmax': 1248, 'ymax': 266}, 'score': '0.9999'}, {'class_name': 'student_info', 'bounding_box': {'xmin': 1123, 'ymin': 299, 'xmax': 1454, 'ymax': 352}, 'score': '0.9974'}]
    adjust_exam_number(regions)